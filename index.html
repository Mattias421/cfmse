---
# Feel free to add content and custom Front Matter to this file.
# To modify the layout, see https://jekyllrb.com/docs/themes/#overriding-theme-defaults

layout: default
---

<style>
    .video-container {
        position: relative;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
        height: 0;
        overflow: hidden;
        max-width: 100%;
        background: #000;
    }
    .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    audio {
       width: 100%;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
   .table-container {
        width: 100%;
        max-width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch; /* For smooth scrolling on mobile devices */
    }
    html, body {
        margin: 5px; /* Get rid of default margins */
        padding: 5px; /* Get rid of default padding */
        overflow-x: hidden; /* Prevent horizontal overflow */
    }
    th, td {
        padding: 4px;
        text-align: left;
        border: 1px solid #ddd;
        font-size: 1em; /* Base font size */
        white-space: nowrap;
    }
    p {
        text-align: justify;
        hyphens: auto;
    }   
    div {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        max-width: 100%;
    }
    /* Define a class for left-aligned text */
    .left-align {
        text-align: left;
        hyphens: none;
    } 
    .container {
        max-width: 100%;
        background-color: #f4f4f4;
        align-items: left;
        overflow-x: auto; /* Handle overflow */
        padding: 0;
        margin: 0 auto;
        position: relative; 
    }
    .inner-container {
        width: calc(100% - 30px);
        background-color: #f4f4f4;
        align-items: left;
        padding: 0;
        margin: 0 auto;
        overflow: hidden;
        position: relative; /* Relative positioning for absolute child positioning */
    }
    pre {
        width: calc(100% - 30px);
        background-color: #f4f4f4;
        border: 0;
        padding: 0px;
        overflow: auto;
        border-radius: 0px;
        margin: 0;
    }
    code {
        font-family: monospace;
        padding: 0px;
        margin: 0;
    }
    .highlight {
        cursor: pointer;
        padding: 4px 4px;
        background-color: #f4f4f4;
        border: 0;
        color: white;
        border-radius: 4px;
        display: flex;
        align-items: center;
        max-width: 100%;
        position: absolute;
        top: 0; /* Position the button at the top */
        right: 0; /* Position the button at the right edge */
        margin: 5px; /* Small margin for aesthetics */
    }
    
    .highlight svg {
        fill: #4e4e4e;
        margin-right: 5px;
    }

    .highlight:hover {
        background-color: #d3d3d3;
    }
</style>

<h1 style="font-size: 1.8em;">
    Flowing Straighter with Conditional Flow Matching for Accurate Speech Enhancement
</h1>

<p class="left-align"></p>
    Mattias Cross, Anton Ragni
</p>

<p>

Current flow-based generative speech enhancement methods learn curved probability paths which model a mapping between clean and noisy speech. 

Despite impressive performance, the implications of curved probability paths are unknown. Methods such as Schrodinger bridges focus on curved paths, where time-dependent gradients and variance do not promote straight paths. Findings in machine learning research suggest that straight paths, such as conditional flow matching, are easier to train and offer better generalisation. Here we show the effect of path straightness on speech enhancement quality.

We report experiments with the Schrodinger bridge, where we show that certain configurations are straighter. Conversely, we propose independent conditional flow-matching for speech enhancement, which models straight paths between noisy and clean speech. 

We identify empirically that a time-independent variance has a greater effect on sample quality than the gradient.
Conditional flow matching improves several speech quality metrics, but requires more inference steps. We rectify this with a one-step solution by inferring the trained flow-based model as if it were directly predictive.

Our work suggests that straighter time-independent probability paths improve generative speech enhancement over curved time-dependent paths.
</p>

<h2>
    Results on VB-DMD
</h2>

<p>
    We evaluate the performance of the proposed models on the VoiceBank-Demand (VB-DMD) dataset. The results are 
    summarized in the table below.
</p>

<div class="table-container">
    <table style="width:100%; border-collapse: collapse;">
        <caption style="caption-side: bottom; text-align: left; padding: 8px; font-style: italic;">
            <strong>Table: Ablation Study and Model Performance on VB-DMD.</strong> Values indicate the mean of the metrics.
        </caption>
        <thead>
            <tr style="border-top: 2px solid black; border-bottom: 2px solid black;">
                <th>Model</th>
                <th>Path</th>
                <th>Loss</th>
                <th>Inference</th>
                <th style="text-align: right;">k</th>
                <th style="text-align: right;">c</th>
                <th style="text-align: right;">PESQ</th>
                <th style="text-align: right;">ESTOI</th>
                <th style="text-align: right;">SI-SDR</th>
                <th style="text-align: right;">DNSMOS</th>
                <th style="text-align: right;">WhiSQA</th>
            </tr>
        </thead>
        <tbody>
            <tr style="border-bottom: 2px solid black;">
                <td>Noisy</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">1.97</td>
                <td style="text-align: right;">0.79</td>
                <td style="text-align: right;">8.4</td>
                <td style="text-align: right;">3.05</td>
                <td style="text-align: right;">3.11</td>
            </tr>
            <tr>
                <td>SB-VE</td>
                <td>DP</td>
                <td>ODE</td>
                <td style="text-align: right;">2.6</td>
                <td style="text-align: right;">0.4</td>
                <td style="text-align: right;">2.92</td>
                <td style="text-align: right;">0.87</td>
                <td style="text-align: right;">19.3</td>
                <td style="text-align: right;">3.56</td>
                <td style="text-align: right;">4.46</td>
            </tr>
            <tr>
                <td>SB-VE</td>
                <td>DP</td>
                <td>DDP</td>
                <td style="text-align: right;">2.6</td>
                <td style="text-align: right;">0.4</td>
                <td style="text-align: right;">2.92</td>
                <td style="text-align: right;">0.87</td>
                <td style="text-align: right;">19.4</td>
                <td style="text-align: right;">3.55</td>
                <td style="text-align: right;">4.45</td>
            </tr>
            <tr style="border-bottom: 2px solid black;">
                <td>SB-VE</td>
                <td>DP</td>
                <td>ODE</td>
                <td style="text-align: right;">0.99</td>
                <td style="text-align: right;">0.375</td>
                <td style="text-align: right;">2.92</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">19.5</td>
                <td style="text-align: right;">3.56</td>
                <td style="text-align: right;">4.47</td>
            </tr>
            <tr>
                <td>SB-SV</td>
                <td>DP</td>
                <td>ODE</td>
                <td style="text-align: right;">2.6</td>
                <td style="text-align: right;">0.15</td>
                <td style="text-align: right;">2.98</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">19.4</td>
                <td style="text-align: right;">3.58</td>
                <td style="text-align: right;"><strong>4.51</strong></td>
            </tr>
            <tr>
                <td>SB-SV</td>
                <td>DP</td>
                <td>DDP</td>
                <td style="text-align: right;">2.6</td>
                <td style="text-align: right;">0.15</td>
                <td style="text-align: right;">2.98</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">19.9</td>
                <td style="text-align: right;">3.58</td>
                <td style="text-align: right;">4.50</td>
            </tr>
            <tr>
                <td>SB-SV</td>
                <td>DP</td>
                <td>ODE</td>
                <td style="text-align: right;">0.99</td>
                <td style="text-align: right;">0.1</td>
                <td style="text-align: right;">2.86</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">19.5</td>
                <td style="text-align: right;">3.58</td>
                <td style="text-align: right;">4.47</td>
            </tr>
            <tr>
                <td>SB-SV</td>
                <td>DP</td>
                <td>DDP</td>
                <td style="text-align: right;">0.99</td>
                <td style="text-align: right;">0.1</td>
                <td style="text-align: right;">2.99</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">20.0</td>
                <td style="text-align: right;">3.57</td>
                <td style="text-align: right;">4.50</td>
            </tr>
            <tr>
                <td>ICFM</td>
                <td>DP</td>
                <td>ODE</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">0.1</td>
                <td style="text-align: right;">2.98</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">20.1</td>
                <td style="text-align: right;">3.59</td>
                <td style="text-align: right;">4.49</td>
            </tr>
            <tr>
                <td>ICFM</td>
                <td>DP</td>
                <td>DDP</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">0.1</td>
                <td style="text-align: right;"><strong>3.05</strong></td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">20.2</td>
                <td style="text-align: right;">3.58</td>
                <td style="text-align: right;"><strong>4.51</strong></td>
            </tr>
            <tr>
                <td>ICFM</td>
                <td>FM</td>
                <td>ODE</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">0.1</td>
                <td style="text-align: right;">2.91</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;">20.3</td>
                <td style="text-align: right;"><strong>3.60</strong></td>
                <td style="text-align: right;">4.50</td>
            </tr>
            <tr style="border-bottom: 2px solid black;">
                <td>ICFM</td>
                <td>FM</td>
                <td>DDP</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">0.1</td>
                <td style="text-align: right;">3.00</td>
                <td style="text-align: right;">0.88</td>
                <td style="text-align: right;"><strong>20.4</strong></td>
                <td style="text-align: right;">3.59</td>
                <td style="text-align: right;"><strong>4.51</strong></td>
            </tr>
        </tbody>
    </table>
</div>

<h2>
    Audio Examples
</h2>

<p>Select an audio file: &nbsp;&nbsp;
    <select id="audioSelect" onchange="updateAudioPlayers()">
        <option value="p257_258">p257_258</option>
        <option value="p232_198">p232_198</option>
        <option value="p257_066">p257_066</option>
        <option value="p232_067">p232_067</option>
        <option value="p257_419">p257_419</option>
        <option value="p232_017">p232_017</option>
        <option value="p257_411">p257_411</option>
        <option value="p232_189">p232_189</option>
        <option value="p257_403">p257_403</option>
        <option value="p232_394">p232_394</option>
        <option value="p257_410">p257_410</option>
        <option value="p232_035">p232_035</option>
        <option value="p257_354">p257_354</option>
        <option value="p232_160">p232_160</option>
        <option value="p257_343">p257_343</option>
        <option value="p232_409">p232_409</option>
        <option value="p257_077">p257_077</option>
        <option value="p232_023">p232_023</option>
        <option value="p257_350">p257_350</option>
        <option value="p232_107">p232_107</option>
    </select>
</p>

<p>
    Noisy Input:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/noisy/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    Clean (Reference):<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/clean/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    ICFM:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/icfm/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    ICFM-DDP:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/icfm_ddp/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    ICFM-FM:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/icfm_fm/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    ICFM-FM-DDP:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/icfm_fm_ddp/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    SBSV:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/sbsv/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    SBSV-DDP:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/sbsv_ddp/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    SBSV (k=1):<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/sbsv_k1/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    SBSV (k=1)-DDP:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/sbsv_k1_ddp/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    SBVE:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/sbve/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio><br>

    SBVE-DDP:<br>
    <audio controls preload="none">
        <source src="https://mattias421.github.io/cfmse/cfmse_samples/sbve_ddp/p257_258.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio>
</p>

<script>
    function updateAudioPlayers() {
        // Get the selected filename (e.g., "p225_001") from the dropdown
        const selectedFile = document.getElementById('audioSelect').value;

        // The base URL for all your audio files
        const baseUrl = "https://mattias421.github.io/cfmse/cfmse_samples/";

        // Get a list of ALL elements with the class 'dynamic-audio-player'
        const audioPlayers = document.querySelectorAll('.dynamic-audio-player');

        // Loop through each audio player
        audioPlayers.forEach(player => {
            // Get the model name (e.g., "icfm_ddp") from the 'data-model' attribute
            const modelName = player.dataset.model;

            // Find the <source> element inside this specific player
            const sourceElement = player.querySelector('source');

            if (modelName && sourceElement) {
                // Construct the new URL for the audio file
                const newSrc = `${baseUrl}${modelName}/${selectedFile}.wav`;

                // Update the 'src' attribute of the source element
                sourceElement.src = newSrc;

                // Tell the audio player to load the new source file
                player.load();
            }
        });
    }

    // Optional: Update players on initial page load to match the first dropdown item
    document.addEventListener('DOMContentLoaded', updateAudioPlayers);
</script>

<br>




<h2 id="citation">
    Citation
</h2>

<div class="container">
    <div class="inner-container" dir="auto" data-snippet-clipboard-copy-content="{% raw %}TBD{% endraw %}">
<pre><code>{% raw %}TBD
{% endraw %}</code></pre>
    </div>
    <button id="copyButton" class="highlight">
        <svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 16 16" width="16" class="octicon octicon-clippy">
            <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path>
            <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
        </svg>
    </button>
</div>

<script>
    document.getElementById('copyButton').addEventListener('click', function() {
        const codeContent = document.querySelector('div[data-snippet-clipboard-copy-content]').getAttribute('data-snippet-clipboard-copy-content');
        navigator.clipboard.writeText(codeContent).then(function() {
        }, function() {
            alert('Failed to copy!');
        });
    });
</script>

<br>

<h2>
    References
</h2>

<ol id="refList" style="list-style-type: none; padding: 0;">
    <!-- JavaScript will populate this list -->
</ol>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const references = {
            "sgmse": "J. Richter, S. Welker, J.-M. Lemercier, B. Lay, and T. Gerkmann, “Speech enhancement and dereverberation with diffusion-based generative models,” IEEE/ACM Transactions on Audio, Speech, and Language Processing, vol. 31, pp. 2351–2364, 2023.",
            "sbse": "A. Jukić, R. Korostik, J. Balam, and B. Ginsburg, “Schrödinger bridge for generative speech enhancement,” ISCA Interspeech, pp. 1175-1179, 2024.",
            "gse":"J. Richter, D. De Oliveira and T. Gerkmann, “Investigating Training Objectives for Generative Speech Enhancement,” ICASSP 2025 - 2025 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), Hyderabad, India, 2025, pp. 1-5",
,
        };

        // Collect keys in order of their appearance, without duplication
        const referenceElements = document.querySelectorAll('.reference');
        const orderedKeys = [];
        referenceElements.forEach(element => {
            // Split the keys and iterate over them
            const keys = element.dataset.ref.split(' ');
            keys.forEach(key => {
                // Add key if it's not already in the list to maintain first appearance order
                if (!orderedKeys.includes(key) && references[key]) {
                    orderedKeys.push(key);
                }
            });
        });
        let sortedReferences = {};
        // Populate the sorted references object based on orderedKeys
        orderedKeys.forEach(key => {
            if (references[key]) {
                sortedReferences[key] = references[key];
            }
        });

        function changeId(element) {
            // Change the id of the clicked element to the next one
            key = element.id.split('-')[1];
            elem = document.getElementById(`link-${key}`);
            elem.href = `#${element.id}`;
        }

        const refList = document.getElementById('refList');
        const refTotal = Object.keys(sortedReferences).length;
        const maxWidth = `${Math.ceil(Math.log10(refTotal + 1)) * 10 + 5}px`;

        Object.entries(sortedReferences).forEach(([key, ref], index) => {
            const refNumber = index + 1;
            const li = document.createElement('li');
            li.id = `ref-${refNumber}`;
            li.style.display = 'flex';
            li.style.alignItems = 'baseline';
            li.style.marginBottom = '5px';

            const numberSpan = document.createElement('span');
            numberSpan.style.fontWeight = 'regular';
            numberSpan.style.minWidth = maxWidth;
            numberSpan.style.textAlign = 'right';
            numberSpan.style.marginRight = '10px';
            numberSpan.style.whiteSpace = 'nowrap';

            const numberLink = document.createElement('a');
            numberLink.href = `#cite-${key}-0`; 
            numberLink.id = `link-${key}`;
            numberLink.textContent = `[${refNumber}]`;
            numberLink.style.textDecoration = 'none';
            numberSpan.appendChild(numberLink);

            const textSpan = document.createElement('span');
            textSpan.textContent = ref;

            li.appendChild(numberSpan);
            li.appendChild(textSpan);
            refList.appendChild(li);
        });

        referenceCounter = {};
        // Making In-text references linkable and combine multiple references
        document.querySelectorAll('.reference').forEach(span => {
            const keys = span.getAttribute('data-ref').split(' ');
            const refNumbers = keys.map(key => {
                const index = Object.keys(sortedReferences).indexOf(key);
                return index + 1;
            });
            keys.forEach((key, i) => {
                if (referenceCounter[key] >= 0) {
                    referenceCounter[key]++;
                } else {
                    referenceCounter[key] = 0;
                }

                // Set up string if there are multiple references
                if (keys.length > 1) {
                    if (i === 0) {
                        refText = `[${refNumbers[i]}, `;
                    } else if (i === keys.length - 1) {
                        refText = `${refNumbers[i]}]`;
                    } else {
                        refText = `${refNumbers[i]}, `;
                    }
                // Set up string if there is only one reference
                } else {
                    refText = `[${refNumbers[i]}]`;
                }

                const citeId = `cite-${key}-${referenceCounter[key]}`;
                const citeLink = document.createElement('a');
                citeLink.href = `#ref-${refNumbers[i]}`;
                citeLink.textContent = refText;
                citeLink.id = citeId;
                citeLink.style.textDecoration = 'none';
                citeLink.addEventListener('click', function () {
                    changeId(this);
                });

                span.appendChild(citeLink);
            });
        });

    });
</script>
